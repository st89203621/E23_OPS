CREATE SCALAR FUNCTION deyeProduceIpType WITH com.semptian.udf.fieldproduction.DeyeProduceIpType;
CREATE SCALAR FUNCTION deyeVerifyIp WITH com.semptian.udf.verify.DeyeVerifyIp;
CREATE SCALAR FUNCTION deyeTimestampConverter WITH com.semptian.udf.timestamphandle.DeyeTimestampConverter;
CREATE SCALAR FUNCTION deyeUserNameNorm WITH com.semptian.udf.normalization.DeyeUserNameNorm;
CREATE SCALAR FUNCTION deyeMacNorm WITH com.semptian.udf.normalization.DeyeMacNorm;
CREATE SCALAR FUNCTION deyePasswordNorm WITH com.semptian.udf.normalization.DeyePasswordNorm;
CREATE SCALAR FUNCTION deyeIpNorm WITH com.semptian.udf.normalization.DeyeIpNorm;
CREATE SCALAR FUNCTION deyeVerifyTimestamp WITH com.semptian.udf.timestamphandle.DeyeVerifyTimestamp;
CREATE SCALAR FUNCTION deyeCompleteActionTypeMap WITH com.semptian.udf.dimcomplete.DeyeCompleteActionTypeMap;
CREATE SCALAR FUNCTION deyeCompleteUpareaTypeMap WITH com.semptian.udf.dimcomplete.DeyeCompleteUpareaTypeMap;
CREATE SCALAR FUNCTION deyeCompleteIspTypeMap WITH com.semptian.udf.dimcomplete.DeyeCompleteIspTypeMap;
CREATE SCALAR FUNCTION deyeMobilePhoneNorm WITH com.semptian.udf.normalization.DeyeMobilePhoneNorm;
CREATE SCALAR FUNCTION deyeCompleteAuthTypeMap WITH com.semptian.udf.dimcomplete.DeyeCompleteAuthTypeMap;
CREATE SCALAR FUNCTION deyeCompleteDataTypeMap WITH com.semptian.udf.dimcomplete.DeyeCompleteDataTypeMap;
CREATE SCALAR FUNCTION deyeCompleteChildTypeMap WITH com.semptian.udf.dimcomplete.DeyeCompleteChildTypeMap;
CREATE SCALAR FUNCTION deyeCompleteDataSourceMap WITH com.semptian.udf.dimcomplete.DeyeCompleteDataSourceMap;
CREATE SCALAR FUNCTION deyeCompleteProtocolTypeMap WITH com.semptian.udf.dimcomplete.DeyeCompleteProtocolTypeMap;
CREATE SCALAR FUNCTION deyeGetRoamType WITH com.semptian.udf.mark.DeyeGetRoamType;
CREATE SCALAR FUNCTION deyeGetSensitiveArea WITH com.semptian.udf.mark.DeyeGetSensitiveArea;
CREATE SCALAR FUNCTION deyeGetTerroristArea WITH com.semptian.udf.mark.DeyeGetTerroristArea;
CREATE SCALAR FUNCTION deyeGetTimeSpan WITH com.semptian.udf.mark.DeyeGetTimeSpan;
CREATE TABLE FUNCTION deyeIpAttributionComp WITH com.semptian.udtf.dimcomplete.DeyeIpAttributionComp;
CREATE TABLE FUNCTION deyeIpAttributionCompV2 WITH com.semptian.udtf.dimcomplete.DeyeIpAttributionCompV2;
CREATE TABLE FUNCTION deyeAuthAccountHandle WITH com.semptian.udtf.normalization.DeyeAuthAccountHandle;
CREATE TABLE FUNCTION deyeDomainHandle WITH com.semptian.udtf.normalization.DeyeDomainHandle;
CREATE TABLE FUNCTION deyeTimeHandle WITH com.semptian.udtf.normalization.DeyeTimeHandle;
CREATE TABLE FUNCTION deyeUserAgentHandle WITH com.semptian.udtf.normalization.DeyeUserAgentHandle;
CREATE SCALAR FUNCTION deyeGetIspByPhoneNumber WITH com.semptian.udf.mark.DeyeGetIspByPhoneNumber;
CREATE SCALAR FUNCTION deyeGetCountryCodeByPhoneNumber WITH com.semptian.udf.DeyeGetCountryCodeByPhoneNumber;
CREATE SCALAR FUNCTION deyeUrlDecode WITH com.semptian.udf.fieldspecialhandle.DeyeUrlDecode;
CREATE SCALAR FUNCTION deyeProduceImportantTargetFlag WITH com.semptian.udf.fieldproduction.DeyeProduceImportantTargetFlag;
CREATE SCALAR FUNCTION deyeCompleteTerminalTypeMap WITH com.semptian.udf.dimcomplete.DeyeCompleteTerminalTypeMap;
CREATE SCALAR FUNCTION deyeOsNameNorm WITH com.semptian.udf.normalization.DeyeOsNameNorm;

CREATE TABLE ods_pr_source_0013_p2p (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  user_id String,
  file_name String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_path String,
  file_size Integer,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  username String,
  password String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  soft_name String,
  favorite_tags String,
  host_url_tag String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_0013_p2p',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_0085_appmarket (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  app_pkg_name String,
  app_list String,
  content String,
  dev_id String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_path String,
  file_size Integer,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imei String,
  associate_mobile String,
  terminal_imei String,
  mobile_phone String,
  imsi String,
  local_action String,
  mac String,
  terminal_imsi String,
  hardware_type String,
  hardware_sign String,
  os_name String,
  os_version String,
  terminal_mac String,
  model String,
  user_agent String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  app_soft_name String,
  favorite_tags String,
  host_url_tag String,
  app_version String,
  brand String,
  remark String,
  soft_name String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_0085_appmarket',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_my0032_softinstall (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  app_pkg_name String,
  app_list String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_path String,
  file_size Integer,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  terminal_imei String,
  mobile_phone String,
  other_imei String,
  relate_imei String,
  terminal_imsi String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  os_name String,
  os_version String,
  terminal_mac String,
  user_agent String,
  android_id String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  app_soft_name String,
  favorite_tags String,
  host_url_tag String,
  app_version String,
  brand String,
  model String,
  soft_name String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_my0032_softinstall',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_0030_webshare (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  host String,
  webshare_icp String,
  user_id String,
  create_time Bigint,
  goods_num Bigint,
  trans_file_size Bigint,
  transfile_path String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_size Integer,
  file_path String,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  soft_name String,
  favorite_tags String,
  host_url_tag String,
  model String,
  app_version String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  username String,
  url String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  os_version String,
  os_name String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_0030_webshare',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_my0030_inputmethod (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  host String,
  username String,
  user_id String,
  content String,
  message String,
  from_app String,
  address String,
  inner_id String,
  user_nick String,
  head_url String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_path String,
  file_size Integer,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  password String,
  url String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  os_version String,
  os_name String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  soft_name String,
  favorite_tags String,
  host_url_tag String,
  brand String,
  model String,
  app_version String,
  remark String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_my0030_inputmethod',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_my0033_iot (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  host String,
  username String,
  user_id String,
  wlw_get_flag String,
  dev_id String,
  to_client_id String,
  peer_user String,
  peer_pwd String,
  safe_question String,
  safe_answer String,
  dev_no String,
  dev_name String,
  head_url String,
  oper_time Bigint,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_path String,
  file_size Integer,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  password String,
  url String,
  `domain` String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  soft_name String,
  favorite_tags String,
  host_url_tag String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_my0033_iot',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_my0065_hackertools (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  content_type String,
  referer String,
  cookie String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  host String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_path String,
  file_size Integer,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  username String,
  password String,
  url String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  user_agent String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  soft_name String,
  favorite_tags String,
  host_url_tag String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_my0065_hackertools',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_my0945_safety (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  host String,
  proxy_type String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_path String,
  file_size Integer,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  username String,
  user_id String,
  password String,
  url String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  soft_name String,
  favorite_tags String,
  host_url_tag String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_my0945_safety',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_my0946_vm (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  host String,
  user_id String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_size Integer,
  file_path String,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  soft_name String,
  favorite_tags String,
  host_url_tag String,
  brand String,
  model String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  username String,
  password String,
  url String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  os_version String,
  os_name String,
  user_agent String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_my0946_vm',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE ods_pr_source_my0034_browser (
  data_type String,
  data_source String,
  protocol_type String,
  child_type String,
  `action` String,
  auth_type String,
  auth_account String,
  proxy_type String,
  proxy_address String,
  proxy_provider String,
  proxy_account String,
  strsrc_ip String,
  strdst_ip String,
  src_port Integer,
  dst_port Integer,
  strsrc_ip_v6 String,
  strdst_ip_v6 String,
  src_port_v6 Integer,
  dst_port_v6 Integer,
  src_ip_area String,
  dst_ip_area String,
  host String,
  username String,
  user_id String,
  uc_login_flag String,
  link_url String,
  address String,
  user_nick String,
  longitude Double,
  latitude Double,
  base_station_id String,
  ownership_land String,
  internet_land String,
  uparea_id String,
  lang_type String,
  abstract String,
  subject String,
  text String,
  attach_text String,
  keywords String,
  attach_names String,
  attach_sizes String,
  attach_md5s String,
  attach_num Integer,
  attach_download_path String,
  file_path String,
  file_size Integer,
  file_id String,
  tool_type String,
  tool_name String,
  isp_id String,
  device_id String,
  trace_id String,
  stream_end_time Bigint,
  up_teid String,
  down_teid String,
  application_layer_protocol String,
  tunnel_type String,
  imsi String,
  imei String,
  associate_mobile String,
  password String,
  url String,
  `domain` String,
  local_action String,
  mac String,
  hardware_type String,
  hardware_sign String,
  browse_version String,
  session_id String,
  icp_provider String,
  rule_version String,
  record_id String,
  soft_name String,
  favorite_tags String,
  host_url_tag String,
  model String,
  capture_time Bigint,
  insert_time Bigint,
  data_id String,
  extend_column String
) WITH (
  'type' = 'kafka',
  'topic' = 'ods_pr_source_my0034_browser',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'group.id' = 'dwd_pr_tool',
  'security.mode.flag' = 'false',
  'session.timeout.ms' = '30000',
  'enable.auto.commit' = 'false',
  'auto.offset.reset' = 'latest',
	'feature.max.poll.records' = '1000',
	'feature.fetch.max.bytes' = '11534336',
	'feature.max.partition.fetch.bytes' = '11534336',
	'feature.fetch.message.max.bytes' = '11534336',
    'feature.request.timeout.ms' = '120000',
    'parallelism' = '8',
  'format.type' = 'avro'
);
CREATE TABLE dwd_pr_tool (
  data_type String,
  data_type_map String,
  child_type String,
  child_type_map String,
  `action` String,
  action_map String,
  auth_account String,
  auth_type String,
  auth_type_map String,
  data_source String,
  data_source_map String,
  mobile_phone String,
  uparea_id String,
  uparea_id_map String,
  username String,
  password String,
  user_nick String,
  user_id String,
  imei String,
  imsi String,
  other_imei String,
  relate_imei String,
  base_station_id String,
  isp_id String,
  isp_id_map String,
  internet_land String,
  ownership_land String,
  application_layer_protocol String,
  down_teid String,
  tunnel_type String,
  up_teid String,
  protocol_type String,
  protocol_type_map String,
  strsrc_ip String,
  strsrc_ip_v6 String,
  strdst_ip String,
  strdst_ip_v6 String,
  dst_port Integer,
  dst_port_v6 Integer,
  src_port Integer,
  src_port_v6 Integer,
  src_ip_type Integer,
  src_ip_country String,
  src_ip_province String,
  src_ip_city String,
  src_ip_address String,
  src_ip_longitude Double,
  src_ip_latitude Double,
  dst_ip_type Integer,
  dst_ip_country String,
  dst_ip_province String,
  dst_ip_city String,
  dst_ip_address String,
  dst_ip_longitude Double,
  dst_ip_latitude Double,
  host String,
  hardware_sign String,
  hardware_type String,
  local_action String,
  mac String,
  os_name String,
  os_version String,
  terminal_type String,
  terminal_type_map String,
  browse_version String,
  android_id String,
  terminal_imei String,
  terminal_imsi String,
  terminal_mac String,
  file_id String,
  file_path String,
  file_size Integer,
  attach_num Integer,
  attach_names String,
  attach_sizes String,
  attach_download_path String,
  attach_md5s String,
  attach_text String,
  subject String,
  keywords String,
  text String,
  lang_type String,
  content String,
  message String,
  url String,
  `domain` String,
  tool_name String,
  tool_type String,
  data_id String,
  capture_time Bigint,
  capture_day String,
  capture_hour Integer,
  insert_time Bigint,
  mark String,
  device_id String,
  trace_id String,
  app_version String,
  app_list String,
  uc_login_flag String,
  cookie String,
  referer String,
  app_pkg_name String,
  head_url String,
  address String,
  from_app String,
  dev_name String,
  dev_no String,
  peer_pwd String,
  peer_user String,
  safe_answer String,
  safe_question String,
  to_client_id String,
  wlw_get_flag String,
  file_name String,
  user_agent String,
  app_soft_name String,
  create_time Bigint,
  goods_num Bigint,
  trans_file_size Bigint,
  transfile_path String,
  webshare_icp String,
  inner_id String,
  link_url String,
  oper_time Bigint,
  proxy_account String,
  proxy_address String,
  proxy_provider String,
  proxy_type String,
  latitude Double,
  longitude Double,
  abstract String,
  brand String,
  favorite_tags String,
  host_url_tag String,
  icp_provider String,
  remark String,
  session_id String,
  soft_name String,
  content_type String,
  stream_end_time Bigint,
  dev_id String,
  model String,
  entity_list String,
  province_attribution String,
  time_span String,
  number_risk_level String,
  radius_risk String,
  roam_type String,
  terrorist_area String,
  sensitive_area String,
  format_virtual_account String,
  format_username String,
  norm_data_type String,
  important_target_flag Integer
) WITH (
  'type' = 'kafka',
  'topic' = 'v64_dwd_pr_tool',
  'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
  'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
  'security.mode.flag' = 'false',
  'format.type' = 'avro',
  'batch.size'='1048576',
  'acks'='1',
  'linger.ms'='100',
  'buffer.memory'='33554432',
  'retries'='1',
  'feature.max.request.size' = '52428800'
);

CREATE TABLE dwd_pr_tmp (
  data_type String,
  data_type_map String,
  auth_account String,
  mobile_phone String,
  username String,
  password String,
  data_id String,
  capture_time Bigint,
  capture_day String,
  capture_hour Integer,
  insert_time Bigint
) WITH (
      'type' = 'kafka',
      'topic' = 'v64_dwd_pr_tmp',
      'bootstrap.servers' = 'hdp-01:6667,hdp-02:6667,hdp-03:6667,hdp-04:6667,hdp-07:6667,hdp-05:6667,hdp-06:6667,hdp-08:6667',
      'zookeeper.connect' = 'hdp-01:2181,hdp-02:2181,hdp-03:2181,hdp-04:2181,hdp-07:2181,hdp-05:2181,hdp-06:2181',
      'security.mode.flag' = 'false',
      'format.type' = 'json',
      'batch.size'='1048576',
      'acks'='1',
      'linger.ms'='100',
      'buffer.memory'='33554432',
      'retries'='1',
      'feature.max.request.size' = '52428800'
      );

INSERT INTO
    dwd_pr_tmp
SELECT
    t1.data_type as data_type,
    deyeCompleteDataTypeMap(t1.data_type, true)[2] as data_type_map,
    t1.auth_account as auth_account,
    t1.mobile_phone as mobile_phone,
    t1.username as username,
    t1.password as password,
    t1.data_id as data_id,
    t1.capture_time as capture_time,
    t1.capture_day as capture_day,
    t1.capture_hour as capture_hour,
    t1.insert_time as insert_time
FROM
    (
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            deyeUserNameNorm(username) as username,
            deyePasswordNorm(password) as password,
            '' as user_nick,
            user_id as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
                WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
                ELSE ''
                END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
                WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
                ELSE ''
                END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            '' as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            '' as os_name,
            '' as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            '' as android_id,
            '' as terminal_imei,
            '' as terminal_imsi,
            '' as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            '' as content,
            '' as message,
            '' as url,
            '' as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            '' as app_version,
            '' as app_list,
            '' as uc_login_flag,
            '' as cookie,
            '' as referer,
            '' as app_pkg_name,
            '' as head_url,
            '' as address,
            '' as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            file_name as file_name,
            '' as user_agent,
            '' as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            '' as inner_id,
            '' as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            '' as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            '' as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            '' as dev_id,
            '' as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_0013_p2p,
            LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '112')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, mobile_phone) as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            '' as username,
            '' as password,
            '' as user_nick,
            '' as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            '' as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            os_name as os_name,
            os_version as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            '' as android_id,
            terminal_imei as terminal_imei,
            terminal_imsi as terminal_imsi,
            terminal_mac as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            content as content,
            '' as message,
            '' as url,
            '' as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            app_version as app_version,
            app_list as app_list,
            '' as uc_login_flag,
            '' as cookie,
            '' as referer,
            app_pkg_name as app_pkg_name,
            '' as head_url,
            '' as address,
            '' as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            '' as file_name,
            user_agent as user_agent,
            app_soft_name as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            '' as inner_id,
            '' as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            brand as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            remark as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            dev_id as dev_id,
            model as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_0085_appmarket,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '157')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, mobile_phone) as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            '' as username,
            '' as password,
            '' as user_nick,
            '' as user_id,
            imei as imei,
            imsi as imsi,
            other_imei as other_imei,
            relate_imei as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            '' as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            os_name as os_name,
            os_version as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            android_id as android_id,
            terminal_imei as terminal_imei,
            terminal_imsi as terminal_imsi,
            terminal_mac as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            '' as content,
            '' as message,
            '' as url,
            '' as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            app_version as app_version,
            app_list as app_list,
            '' as uc_login_flag,
            '' as cookie,
            '' as referer,
            app_pkg_name as app_pkg_name,
            '' as head_url,
            '' as address,
            '' as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            '' as file_name,
            user_agent as user_agent,
            app_soft_name as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            '' as inner_id,
            '' as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            brand as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            '' as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            '' as dev_id,
            model as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_my0032_softinstall,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '976')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            deyeUserNameNorm(username) as username,
            '' as password,
            '' as user_nick,
            user_id as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            host as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            os_name as os_name,
            os_version as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            '' as android_id,
            '' as terminal_imei,
            '' as terminal_imsi,
            '' as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            '' as content,
            '' as message,
            url as url,
            T8.domain_l as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            app_version as app_version,
            '' as app_list,
            '' as uc_login_flag,
            '' as cookie,
            '' as referer,
            '' as app_pkg_name,
            '' as head_url,
            '' as address,
            '' as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            '' as file_name,
            '' as user_agent,
            '' as app_soft_name,
            create_time as create_time,
            goods_num as goods_num,
            trans_file_size as trans_file_size,
            transfile_path as transfile_path,
            webshare_icp as webshare_icp,
            '' as inner_id,
            '' as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            '' as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            '' as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            '' as dev_id,
            model as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_0030_webshare,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '128')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            deyeUserNameNorm(username) as username,
            deyePasswordNorm(password) as password,
            user_nick as user_nick,
            user_id as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            host as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            os_name as os_name,
            os_version as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            '' as android_id,
            '' as terminal_imei,
            '' as terminal_imsi,
            '' as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            content as content,
            message as message,
            url as url,
            T8.domain_l as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            app_version as app_version,
            '' as app_list,
            '' as uc_login_flag,
            '' as cookie,
            '' as referer,
            '' as app_pkg_name,
            head_url as head_url,
            address as address,
            from_app as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            '' as file_name,
            '' as user_agent,
            '' as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            inner_id as inner_id,
            '' as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            brand as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            remark as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            '' as dev_id,
            model as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_my0030_inputmethod,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '978')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            deyeUserNameNorm(username) as username,
            deyePasswordNorm(password) as password,
            '' as user_nick,
            user_id as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            host as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            '' as os_name,
            '' as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            '' as android_id,
            '' as terminal_imei,
            '' as terminal_imsi,
            '' as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            '' as content,
            '' as message,
            url as url,
            T8.domain_l as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            '' as app_version,
            '' as app_list,
            '' as uc_login_flag,
            '' as cookie,
            '' as referer,
            '' as app_pkg_name,
            head_url as head_url,
            '' as address,
            '' as from_app,
            dev_name as dev_name,
            dev_no as dev_no,
            peer_pwd as peer_pwd,
            peer_user as peer_user,
            safe_answer as safe_answer,
            safe_question as safe_question,
            to_client_id as to_client_id,
            wlw_get_flag as wlw_get_flag,
            '' as file_name,
            '' as user_agent,
            '' as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            '' as inner_id,
            '' as link_url,
            oper_time as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            '' as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            '' as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            dev_id as dev_id,
            '' as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_my0033_iot,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeDomainHandle(`domain`, url)) as T8(domain_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '975')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            deyeUserNameNorm(username) as username,
            deyePasswordNorm(password) as password,
            '' as user_nick,
            '' as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            host as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            '' as os_name,
            '' as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            '' as android_id,
            '' as terminal_imei,
            '' as terminal_imsi,
            '' as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            '' as content,
            '' as message,
            url as url,
            T8.domain_l as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            '' as app_version,
            '' as app_list,
            '' as uc_login_flag,
            cookie as cookie,
            referer as referer,
            '' as app_pkg_name,
            '' as head_url,
            '' as address,
            '' as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            '' as file_name,
            user_agent as user_agent,
            '' as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            '' as inner_id,
            '' as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            '' as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            '' as remark,
            session_id as session_id,
            soft_name as soft_name,
            content_type as content_type,
            stream_end_time as stream_end_time,
            '' as dev_id,
            '' as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_my0065_hackertools,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '949')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            deyeUserNameNorm(username) as username,
            deyePasswordNorm(password) as password,
            '' as user_nick,
            user_id as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            host as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            '' as os_name,
            '' as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            '' as android_id,
            '' as terminal_imei,
            '' as terminal_imsi,
            '' as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            '' as content,
            '' as message,
            url as url,
            T8.domain_l as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            '' as app_version,
            '' as app_list,
            '' as uc_login_flag,
            '' as cookie,
            '' as referer,
            '' as app_pkg_name,
            '' as head_url,
            '' as address,
            '' as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            '' as file_name,
            '' as user_agent,
            '' as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            '' as inner_id,
            '' as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            '' as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            '' as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            '' as dev_id,
            '' as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_my0945_safety,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '945')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            deyeUserNameNorm(username) as username,
            deyePasswordNorm(password) as password,
            '' as user_nick,
            user_id as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            host as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            os_name as os_name,
            os_version as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            '' as browse_version,
            '' as android_id,
            '' as terminal_imei,
            '' as terminal_imsi,
            '' as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            '' as content,
            '' as message,
            url as url,
            T8.domain_l as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            '' as app_version,
            '' as app_list,
            '' as uc_login_flag,
            '' as cookie,
            '' as referer,
            '' as app_pkg_name,
            '' as head_url,
            '' as address,
            '' as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            '' as file_name,
            user_agent as user_agent,
            '' as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            '' as inner_id,
            '' as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            brand as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            '' as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            '' as dev_id,
            model as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_my0946_vm,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '946')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
        UNION ALL
        SELECT
            data_type as data_type,
            deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
            deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
            deyeCompleteActionTypeMap(`action`)[1] as `action`,
            deyeCompleteActionTypeMap(`action`)[2] as action_map,
            T3.auth_account_l as auth_account,
            T3.auth_type_l as auth_type,
            deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
            data_source as data_source,
            deyeCompleteDataSourceMap(data_source) as data_source_map,
            deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
            uparea_id as uparea_id,
            deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
            deyeUserNameNorm(username) as username,
            deyePasswordNorm(password) as password,
            user_nick as user_nick,
            user_id as user_id,
            imei as imei,
            imsi as imsi,
            '' as other_imei,
            '' as relate_imei,
            base_station_id as base_station_id,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as isp_id,
            deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
            internet_land as internet_land,
            CASE
            WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
            ELSE ''
            END as ownership_land,
            application_layer_protocol as application_layer_protocol,
            down_teid as down_teid,
            tunnel_type as tunnel_type,
            up_teid as up_teid,
            protocol_type as protocol_type,
            deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
            deyeIpNorm(strsrc_ip) as strsrc_ip,
            deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
            deyeIpNorm(strdst_ip) as strdst_ip,
            deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
            dst_port as dst_port,
            dst_port_v6 as dst_port_v6,
            src_port as src_port,
            src_port_v6 as src_port_v6,
            deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
            deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
            host as host,
            hardware_sign as hardware_sign,
            hardware_type as hardware_type,
            local_action as local_action,
            deyeMacNorm(mac) as mac,
            '' as os_name,
            '' as os_version,
            '' as terminal_type,
            '' as terminal_type_map,
            browse_version as browse_version,
            '' as android_id,
            '' as terminal_imei,
            '' as terminal_imsi,
            '' as terminal_mac,
            file_id as file_id,
            file_path as file_path,
            file_size as file_size,
            attach_num as attach_num,
            attach_names as attach_names,
            attach_sizes as attach_sizes,
            attach_download_path as attach_download_path,
            attach_md5s as attach_md5s,
            attach_text as attach_text,
            subject as subject,
            keywords as keywords,
            text as text,
            lang_type as lang_type,
            '' as content,
            '' as message,
            url as url,
            T8.domain_l as `domain`,
            tool_name as tool_name,
            tool_type as tool_type,
            data_id as data_id,
            capture_time as capture_time,
            T9.capture_day_l as capture_day,
            T9.capture_hour_l as capture_hour,
            deyeTimestampConverter(data_id) as insert_time,
            '' as mark,
            device_id as device_id,
            trace_id as trace_id,
            '' as app_version,
            '' as app_list,
            uc_login_flag as uc_login_flag,
            '' as cookie,
            '' as referer,
            '' as app_pkg_name,
            '' as head_url,
            address as address,
            '' as from_app,
            '' as dev_name,
            '' as dev_no,
            '' as peer_pwd,
            '' as peer_user,
            '' as safe_answer,
            '' as safe_question,
            '' as to_client_id,
            '' as wlw_get_flag,
            '' as file_name,
            '' as user_agent,
            '' as app_soft_name,
            0 as create_time,
            0 as goods_num,
            0 as trans_file_size,
            '' as transfile_path,
            '' as webshare_icp,
            '' as inner_id,
            link_url as link_url,
            0 as oper_time,
            proxy_account as proxy_account,
            proxy_address as proxy_address,
            proxy_provider as proxy_provider,
            proxy_type as proxy_type,
            latitude as latitude,
            longitude as longitude,
            abstract as abstract,
            '' as brand,
            favorite_tags as favorite_tags,
            host_url_tag as host_url_tag,
            icp_provider as icp_provider,
            '' as remark,
            session_id as session_id,
            soft_name as soft_name,
            '' as content_type,
            stream_end_time as stream_end_time,
            '' as dev_id,
            model as model,
            '' as entity_list,
            '' as province_attribution,
            deyeGetTimeSpan(capture_time) as time_span,
            '' as number_risk_level,
            '' as radius_risk,
            '' as roam_type
        FROM
            ods_pr_source_my0034_browser,
            LATERAL TABLE(
            deyeAuthAccountHandle(
            auth_type,
            auth_account,
            data_type,
            deyeIpNorm(strsrc_ip),
            deyeIpNorm(strsrc_ip_v6),
            deyeIpNorm(strdst_ip),
            deyeIpNorm(strdst_ip_v6),
            capture_time
            )
            ) as T3(auth_type_l, auth_account_l),
            LATERAL TABLE(deyeDomainHandle(`domain`, url)) as T8(domain_l),
            LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
        WHERE
            (
            (data_type = '156')
          AND (deyeVerifyTimestamp(capture_time, -2) = '1')
          AND (deyeVerifyTimestamp(capture_time, 1) = '0')
          AND (
            deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
            )
          AND (
            deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
            )
            )
    ) t1
WHERE (
       CHAR_LENGTH(t1.auth_account) > 128
       OR CHAR_LENGTH(t1.mobile_phone) > 30
       OR CHAR_LENGTH(t1.username) > 512
       OR CHAR_LENGTH(t1.password) > 512
   );

INSERT INTO
  dwd_pr_tool
SELECT
  t1.data_type as data_type,
  deyeCompleteDataTypeMap(t1.data_type, true)[2] as data_type_map,
  t1.child_type as child_type,
  t1.child_type_map as child_type_map,
  t1. `action` as `action`,
  t1.action_map as action_map,
  t1.auth_account as auth_account,
  t1.auth_type as auth_type,
  t1.auth_type_map as auth_type_map,
  t1.data_source as data_source,
  t1.data_source_map as data_source_map,
  t1.mobile_phone as mobile_phone,
  t1.uparea_id as uparea_id,
  t1.uparea_id_map as uparea_id_map,
  t1.username as username,
  t1.password as password,
  t1.user_nick as user_nick,
  t1.user_id as user_id,
  t1.imei as imei,
  t1.imsi as imsi,
  t1.other_imei as other_imei,
  t1.relate_imei as relate_imei,
  t1.base_station_id as base_station_id,
  t1.isp_id as isp_id,
  t1.isp_id_map as isp_id_map,
  t1.internet_land as internet_land,
  t1.ownership_land as ownership_land,
  t1.application_layer_protocol as application_layer_protocol,
  t1.down_teid as down_teid,
  t1.tunnel_type as tunnel_type,
  t1.up_teid as up_teid,
  t1.protocol_type as protocol_type,
  t1.protocol_type_map as protocol_type_map,
  t1.strsrc_ip as strsrc_ip,
  t1.strsrc_ip_v6 as strsrc_ip_v6,
  t1.strdst_ip as strdst_ip,
  t1.strdst_ip_v6 as strdst_ip_v6,
  t1.dst_port as dst_port,
  t1.dst_port_v6 as dst_port_v6,
  t1.src_port as src_port,
  t1.src_port_v6 as src_port_v6,
  t1.src_ip_type as src_ip_type,
  T1.src_ip_country_l as src_ip_country,
  T1.src_ip_province_l as src_ip_province,
  T1.src_ip_city_l as src_ip_city,
  T1.src_ip_address_l as src_ip_address,
  T1.src_ip_longitude_l as src_ip_longitude,
  T1.src_ip_latitude_l as src_ip_latitude,
  t1.dst_ip_type as dst_ip_type,
  T2.dst_ip_country_l as dst_ip_country,
  T2.dst_ip_province_l as dst_ip_province,
  T2.dst_ip_city_l as dst_ip_city,
  T2.dst_ip_address_l as dst_ip_address,
  T2.dst_ip_longitude_l as dst_ip_longitude,
  T2.dst_ip_latitude_l as dst_ip_latitude,
  case
    when position(':' in t1.host)>0 then substring(t1.host,1,position(':' in t1.host) -1)
    else t1.host
  end as host,
  t1.hardware_sign as hardware_sign,
  t1.hardware_type as hardware_type,
  t1.local_action as local_action,
  t1.mac as mac,
  IF(t1.user_agent<>'',T11.os_type_l,deyeOsNameNorm(t1.os_name)) as os_name,
  t1.os_version as os_version,
  IF(t1.user_agent<>'',T11.terminal_type_l,'') as terminal_type,
  deyeCompleteTerminalTypeMap(IF(t1.user_agent<>'',T11.terminal_type_l,'')) as terminal_type_map,
  t1.browse_version as browse_version,
  t1.android_id as android_id,
  t1.terminal_imei as terminal_imei,
  t1.terminal_imsi as terminal_imsi,
  t1.terminal_mac as terminal_mac,
  t1.file_id as file_id,
  t1.file_path as file_path,
  t1.file_size as file_size,
  t1.attach_num as attach_num,
  t1.attach_names as attach_names,
  t1.attach_sizes as attach_sizes,
  t1.attach_download_path as attach_download_path,
  t1.attach_md5s as attach_md5s,
  t1.attach_text as attach_text,
  t1.subject as subject,
  t1.keywords as keywords,
  t1.text as text,
  SPLIT_INDEX(IF(LEFT(t1.lang_type,1)='[' AND RIGHT(t1.lang_type,1)=']', SUBSTR(t1.lang_type,2,CHAR_LENGTH(t1.lang_type)-2), t1.lang_type),' ',0) as lang_type,
  t1.content as content,
  t1.message as message,
  deyeUrlDecode(t1.url) as url,
  deyeUrlDecode(t1.`domain`) as `domain`,
  t1.child_type_map as tool_name,
  t1.child_type as tool_type,
  t1.data_id as data_id,
  t1.capture_time as capture_time,
  t1.capture_day as capture_day,
  t1.capture_hour as capture_hour,
  t1.insert_time as insert_time,
  t1.mark as mark,
  t1.device_id as device_id,
  t1.trace_id as trace_id,
  t1.app_version as app_version,
  t1.app_list as app_list,
  t1.uc_login_flag as uc_login_flag,
  t1.cookie as cookie,
  t1.referer as referer,
  t1.app_pkg_name as app_pkg_name,
  t1.head_url as head_url,
  t1.address as address,
  t1.from_app as from_app,
  t1.dev_name as dev_name,
  t1.dev_no as dev_no,
  t1.peer_pwd as peer_pwd,
  t1.peer_user as peer_user,
  t1.safe_answer as safe_answer,
  t1.safe_question as safe_question,
  t1.to_client_id as to_client_id,
  t1.wlw_get_flag as wlw_get_flag,
  t1.file_name as file_name,
  t1.user_agent as user_agent,
  t1.app_soft_name as app_soft_name,
  t1.create_time as create_time,
  t1.goods_num as goods_num,
  t1.trans_file_size as trans_file_size,
  t1.transfile_path as transfile_path,
  t1.webshare_icp as webshare_icp,
  t1.inner_id as inner_id,
  t1.link_url as link_url,
  t1.oper_time as oper_time,
  t1.proxy_account as proxy_account,
  t1.proxy_address as proxy_address,
  t1.proxy_provider as proxy_provider,
  t1.proxy_type as proxy_type,
  t1.latitude as latitude,
  t1.longitude as longitude,
  t1.abstract as abstract,
  t1.brand as brand,
  t1.favorite_tags as favorite_tags,
  t1.host_url_tag as host_url_tag,
  t1.icp_provider as icp_provider,
  t1.remark as remark,
  t1.session_id as session_id,
  t1.soft_name as soft_name,
  t1.content_type as content_type,
  t1.stream_end_time as stream_end_time,
  t1.dev_id as dev_id,
  t1.model as model,
  t1.entity_list as entity_list,
  t1.province_attribution as province_attribution,
  t1.time_span as time_span,
  t1.number_risk_level as number_risk_level,
  t1.radius_risk as radius_risk,
  t1.roam_type as roam_type,
  deyeGetTerroristArea(
    deyeGetCountryCodeByPhoneNumber(t1.auth_account),
    'DZ',
    T1.src_ip_country_code_l
  ) as terrorist_area,
  deyeGetSensitiveArea(
    deyeGetCountryCodeByPhoneNumber(t1.auth_account),
    'DZ',
    T1.src_ip_country_code_l
  ) as sensitive_area,
  '' AS format_virtual_account,
  LOWER(t1.username) as format_username,
  deyeCompleteDataTypeMap(t1.data_type, true)[1] as norm_data_type,
  deyeProduceImportantTargetFlag(data_type,t1.auth_account,t1.auth_type,deyeIpNorm(strsrc_ip),deyeIpNorm(strsrc_ip_v6),deyeIpNorm(strdst_ip),deyeIpNorm(strdst_ip_v6)) as important_target_flag
FROM
  (
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      deyeUserNameNorm(username) as username,
      deyePasswordNorm(password) as password,
      '' as user_nick,
      user_id as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      '' as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      '' as os_name,
      '' as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      '' as android_id,
      '' as terminal_imei,
      '' as terminal_imsi,
      '' as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      '' as content,
      '' as message,
      '' as url,
      '' as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      '' as app_version,
      '' as app_list,
      '' as uc_login_flag,
      '' as cookie,
      '' as referer,
      '' as app_pkg_name,
      '' as head_url,
      '' as address,
      '' as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      file_name as file_name,
      '' as user_agent,
      '' as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      '' as inner_id,
      '' as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      '' as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      '' as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      '' as dev_id,
      '' as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_0013_p2p,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '112')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, mobile_phone) as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      '' as username,
      '' as password,
      '' as user_nick,
      '' as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      '' as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      os_name as os_name,
      os_version as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      '' as android_id,
      terminal_imei as terminal_imei,
      terminal_imsi as terminal_imsi,
      terminal_mac as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      content as content,
      '' as message,
      '' as url,
      '' as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      app_version as app_version,
      app_list as app_list,
      '' as uc_login_flag,
      '' as cookie,
      '' as referer,
      app_pkg_name as app_pkg_name,
      '' as head_url,
      '' as address,
      '' as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      '' as file_name,
      user_agent as user_agent,
      app_soft_name as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      '' as inner_id,
      '' as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      brand as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      remark as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      dev_id as dev_id,
      model as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_0085_appmarket,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '157')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, mobile_phone) as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      '' as username,
      '' as password,
      '' as user_nick,
      '' as user_id,
      imei as imei,
      imsi as imsi,
      other_imei as other_imei,
      relate_imei as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      '' as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      os_name as os_name,
      os_version as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      android_id as android_id,
      terminal_imei as terminal_imei,
      terminal_imsi as terminal_imsi,
      terminal_mac as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      '' as content,
      '' as message,
      '' as url,
      '' as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      app_version as app_version,
      app_list as app_list,
      '' as uc_login_flag,
      '' as cookie,
      '' as referer,
      app_pkg_name as app_pkg_name,
      '' as head_url,
      '' as address,
      '' as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      '' as file_name,
      user_agent as user_agent,
      app_soft_name as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      '' as inner_id,
      '' as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      brand as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      '' as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      '' as dev_id,
      model as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_my0032_softinstall,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '976')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      deyeUserNameNorm(username) as username,
      '' as password,
      '' as user_nick,
      user_id as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      host as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      os_name as os_name,
      os_version as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      '' as android_id,
      '' as terminal_imei,
      '' as terminal_imsi,
      '' as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      '' as content,
      '' as message,
      url as url,
      T8.domain_l as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      app_version as app_version,
      '' as app_list,
      '' as uc_login_flag,
      '' as cookie,
      '' as referer,
      '' as app_pkg_name,
      '' as head_url,
      '' as address,
      '' as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      '' as file_name,
      '' as user_agent,
      '' as app_soft_name,
      create_time as create_time,
      goods_num as goods_num,
      trans_file_size as trans_file_size,
      transfile_path as transfile_path,
      webshare_icp as webshare_icp,
      '' as inner_id,
      '' as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      '' as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      '' as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      '' as dev_id,
      model as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_0030_webshare,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '128')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      deyeUserNameNorm(username) as username,
      deyePasswordNorm(password) as password,
      user_nick as user_nick,
      user_id as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      host as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      os_name as os_name,
      os_version as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      '' as android_id,
      '' as terminal_imei,
      '' as terminal_imsi,
      '' as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      content as content,
      message as message,
      url as url,
      T8.domain_l as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      app_version as app_version,
      '' as app_list,
      '' as uc_login_flag,
      '' as cookie,
      '' as referer,
      '' as app_pkg_name,
      head_url as head_url,
      address as address,
      from_app as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      '' as file_name,
      '' as user_agent,
      '' as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      inner_id as inner_id,
      '' as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      brand as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      remark as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      '' as dev_id,
      model as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_my0030_inputmethod,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '978')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      deyeUserNameNorm(username) as username,
      deyePasswordNorm(password) as password,
      '' as user_nick,
      user_id as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      host as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      '' as os_name,
      '' as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      '' as android_id,
      '' as terminal_imei,
      '' as terminal_imsi,
      '' as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      '' as content,
      '' as message,
      url as url,
      T8.domain_l as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      '' as app_version,
      '' as app_list,
      '' as uc_login_flag,
      '' as cookie,
      '' as referer,
      '' as app_pkg_name,
      head_url as head_url,
      '' as address,
      '' as from_app,
      dev_name as dev_name,
      dev_no as dev_no,
      peer_pwd as peer_pwd,
      peer_user as peer_user,
      safe_answer as safe_answer,
      safe_question as safe_question,
      to_client_id as to_client_id,
      wlw_get_flag as wlw_get_flag,
      '' as file_name,
      '' as user_agent,
      '' as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      '' as inner_id,
      '' as link_url,
      oper_time as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      '' as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      '' as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      dev_id as dev_id,
      '' as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_my0033_iot,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeDomainHandle(`domain`, url)) as T8(domain_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '975')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      deyeUserNameNorm(username) as username,
      deyePasswordNorm(password) as password,
      '' as user_nick,
      '' as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      host as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      '' as os_name,
      '' as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      '' as android_id,
      '' as terminal_imei,
      '' as terminal_imsi,
      '' as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      '' as content,
      '' as message,
      url as url,
      T8.domain_l as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      '' as app_version,
      '' as app_list,
      '' as uc_login_flag,
      cookie as cookie,
      referer as referer,
      '' as app_pkg_name,
      '' as head_url,
      '' as address,
      '' as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      '' as file_name,
      user_agent as user_agent,
      '' as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      '' as inner_id,
      '' as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      '' as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      '' as remark,
      session_id as session_id,
      soft_name as soft_name,
      content_type as content_type,
      stream_end_time as stream_end_time,
      '' as dev_id,
      '' as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_my0065_hackertools,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '949')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      deyeUserNameNorm(username) as username,
      deyePasswordNorm(password) as password,
      '' as user_nick,
      user_id as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      host as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      '' as os_name,
      '' as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      '' as android_id,
      '' as terminal_imei,
      '' as terminal_imsi,
      '' as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      '' as content,
      '' as message,
      url as url,
      T8.domain_l as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      '' as app_version,
      '' as app_list,
      '' as uc_login_flag,
      '' as cookie,
      '' as referer,
      '' as app_pkg_name,
      '' as head_url,
      '' as address,
      '' as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      '' as file_name,
      '' as user_agent,
      '' as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      '' as inner_id,
      '' as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      '' as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      '' as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      '' as dev_id,
      '' as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_my0945_safety,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '945')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      deyeUserNameNorm(username) as username,
      deyePasswordNorm(password) as password,
      '' as user_nick,
      user_id as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      host as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      os_name as os_name,
      os_version as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      '' as browse_version,
      '' as android_id,
      '' as terminal_imei,
      '' as terminal_imsi,
      '' as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      '' as content,
      '' as message,
      url as url,
      T8.domain_l as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      '' as app_version,
      '' as app_list,
      '' as uc_login_flag,
      '' as cookie,
      '' as referer,
      '' as app_pkg_name,
      '' as head_url,
      '' as address,
      '' as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      '' as file_name,
      user_agent as user_agent,
      '' as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      '' as inner_id,
      '' as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      brand as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      '' as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      '' as dev_id,
      model as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_my0946_vm,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeDomainHandle('', url)) as T8(domain_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '946')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
    UNION ALL
    SELECT
      data_type as data_type,
      deyeCompleteChildTypeMap(child_type, data_type)[1] as child_type,
      deyeCompleteChildTypeMap(child_type, data_type)[2] as child_type_map,
      deyeCompleteActionTypeMap(`action`)[1] as `action`,
      deyeCompleteActionTypeMap(`action`)[2] as action_map,
      T3.auth_account_l as auth_account,
      T3.auth_type_l as auth_type,
      deyeCompleteAuthTypeMap(T3.auth_type_l) as auth_type_map,
      data_source as data_source,
      deyeCompleteDataSourceMap(data_source) as data_source_map,
      deyeMobilePhoneNorm(associate_mobile, '') as mobile_phone,
      uparea_id as uparea_id,
      deyeCompleteUpareaTypeMap(uparea_id) as uparea_id_map,
      deyeUserNameNorm(username) as username,
      deyePasswordNorm(password) as password,
      user_nick as user_nick,
      user_id as user_id,
      imei as imei,
      imsi as imsi,
      '' as other_imei,
      '' as relate_imei,
      base_station_id as base_station_id,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetIspByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as isp_id,
      deyeCompleteIspTypeMap(CASE WHEN(auth_type = '1020004') THEN deyeGetIspByPhoneNumber(T3.auth_account_l) ELSE '' END) as isp_id_map,
      internet_land as internet_land,
      CASE
        WHEN auth_type = '1020004' THEN deyeGetCountryCodeByPhoneNumber(T3.auth_account_l)
        ELSE ''
      END as ownership_land,
      application_layer_protocol as application_layer_protocol,
      down_teid as down_teid,
      tunnel_type as tunnel_type,
      up_teid as up_teid,
      protocol_type as protocol_type,
      deyeCompleteProtocolTypeMap(protocol_type) as protocol_type_map,
      deyeIpNorm(strsrc_ip) as strsrc_ip,
      deyeIpNorm(strsrc_ip_v6) as strsrc_ip_v6,
      deyeIpNorm(strdst_ip) as strdst_ip,
      deyeIpNorm(strdst_ip_v6) as strdst_ip_v6,
      dst_port as dst_port,
      dst_port_v6 as dst_port_v6,
      src_port as src_port,
      src_port_v6 as src_port_v6,
      deyeProduceIpType(strsrc_ip, strsrc_ip_v6) as src_ip_type,
      deyeProduceIpType(strdst_ip, strdst_ip_v6) as dst_ip_type,
      host as host,
      hardware_sign as hardware_sign,
      hardware_type as hardware_type,
      local_action as local_action,
      deyeMacNorm(mac) as mac,
      '' as os_name,
      '' as os_version,
      '' as terminal_type,
      '' as terminal_type_map,
      browse_version as browse_version,
      '' as android_id,
      '' as terminal_imei,
      '' as terminal_imsi,
      '' as terminal_mac,
      file_id as file_id,
      file_path as file_path,
      file_size as file_size,
      attach_num as attach_num,
      attach_names as attach_names,
      attach_sizes as attach_sizes,
      attach_download_path as attach_download_path,
      attach_md5s as attach_md5s,
      attach_text as attach_text,
      subject as subject,
      keywords as keywords,
      text as text,
      lang_type as lang_type,
      '' as content,
      '' as message,
      url as url,
      T8.domain_l as `domain`,
      tool_name as tool_name,
      tool_type as tool_type,
      data_id as data_id,
      capture_time as capture_time,
      T9.capture_day_l as capture_day,
      T9.capture_hour_l as capture_hour,
      deyeTimestampConverter(data_id) as insert_time,
      '' as mark,
      device_id as device_id,
      trace_id as trace_id,
      '' as app_version,
      '' as app_list,
      uc_login_flag as uc_login_flag,
      '' as cookie,
      '' as referer,
      '' as app_pkg_name,
      '' as head_url,
      address as address,
      '' as from_app,
      '' as dev_name,
      '' as dev_no,
      '' as peer_pwd,
      '' as peer_user,
      '' as safe_answer,
      '' as safe_question,
      '' as to_client_id,
      '' as wlw_get_flag,
      '' as file_name,
      '' as user_agent,
      '' as app_soft_name,
      0 as create_time,
      0 as goods_num,
      0 as trans_file_size,
      '' as transfile_path,
      '' as webshare_icp,
      '' as inner_id,
      link_url as link_url,
      0 as oper_time,
      proxy_account as proxy_account,
      proxy_address as proxy_address,
      proxy_provider as proxy_provider,
      proxy_type as proxy_type,
      latitude as latitude,
      longitude as longitude,
      abstract as abstract,
      '' as brand,
      favorite_tags as favorite_tags,
      host_url_tag as host_url_tag,
      icp_provider as icp_provider,
      '' as remark,
      session_id as session_id,
      soft_name as soft_name,
      '' as content_type,
      stream_end_time as stream_end_time,
      '' as dev_id,
      model as model,
      '' as entity_list,
      '' as province_attribution,
      deyeGetTimeSpan(capture_time) as time_span,
      '' as number_risk_level,
      '' as radius_risk,
      '' as roam_type
    FROM
      ods_pr_source_my0034_browser,
      LATERAL TABLE(
        deyeAuthAccountHandle(
          auth_type,
          auth_account,
          data_type,
          deyeIpNorm(strsrc_ip),
          deyeIpNorm(strsrc_ip_v6),
          deyeIpNorm(strdst_ip),
          deyeIpNorm(strdst_ip_v6),
          capture_time
        )
      ) as T3(auth_type_l, auth_account_l),
      LATERAL TABLE(deyeDomainHandle(`domain`, url)) as T8(domain_l),
      LATERAL TABLE(deyeTimeHandle(capture_time)) as T9(capture_day_l, capture_hour_l)
    WHERE
      (
        (data_type = '156')
        AND (deyeVerifyTimestamp(capture_time, -2) = '1')
        AND (deyeVerifyTimestamp(capture_time, 1) = '0')
        AND (
          deyeVerifyIp(strsrc_ip, strsrc_ip_v6) = '1'
        )
        AND (
          deyeVerifyIp(strdst_ip, strdst_ip_v6) = '1'
        )
      )
  ) t1,
  LATERAL TABLE(deyeIpAttributionCompV2(IF(strsrc_ip='', strsrc_ip_v6,strsrc_ip))) as T1(
    src_ip_address_l,
    src_ip_country_l,
    src_ip_province_l,
    src_ip_city_l,
    src_ip_longitude_l,
    src_ip_latitude_l,
    src_ip_country_code_l
  ),
  LATERAL TABLE(deyeIpAttributionCompV2(IF(strdst_ip='', strdst_ip_v6,strdst_ip))) as T2(
    dst_ip_address_l,
    dst_ip_country_l,
    dst_ip_province_l,
    dst_ip_city_l,
    dst_ip_longitude_l,
    dst_ip_latitude_l,
    dst_ip_country_code_l
  ),
  LATERAL TABLE(deyeUserAgentHandle(user_agent)) as T11(browse_type_l, os_type_l, terminal_type_l)
WHERE (
    CHAR_LENGTH(t1.auth_account) <= 128
  AND CHAR_LENGTH(t1.mobile_phone) <= 30
  AND CHAR_LENGTH(t1.username) <= 512
  AND CHAR_LENGTH(t1.password) <= 512
    );